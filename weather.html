<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>天气预报组件</title>
    <style>
        .weather-widget {
            font-family: Arial, sans-serif;
            width: 300px;
            padding: 20px;
            border-radius: 10px;
            background: linear-gradient(135deg, #00b4db, #0083b0);
            color: white;
        }
        .weather-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .temperature {
            font-size: 2em;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="weather-widget">
        <div id="location">加载中...</div>
        <div class="weather-info">
            <div class="temperature" id="temp"></div>
            <div id="description"></div>
        </div>
    </div>

    <script>
    const API_KEY = '10588fb4e4b938383c91d031736b7b8a';

    // 添加错误处理的getWeather函数
    async function getWeather(city = '北京') {
        try {
            const response = await fetch(
                `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${API_KEY}&units=metric&lang=zh_cn`
            );
            if (!response.ok) {
                throw new Error('Weather data fetch failed');
            }
            const data = await response.json();
            updateWeatherDisplay(data);
        } catch (error) {
            document.getElementById('location').textContent = '获取天气失败';
            console.error('Error:', error);
        }
    }

    // 添加数据显示函数
    function updateWeatherDisplay(data) {
        document.getElementById('location').textContent = data.name;
        document.getElementById('temp').textContent = `${Math.round(data.main.temp)}°C`;
        document.getElementById('description').textContent = data.weather[0].description;
    }

    // 页面加载完成后执行
    document.addEventListener('DOMContentLoaded', () => {
        getWeather();
    });

    // 每30分钟更新一次天气数据
    setInterval(() => {
        getWeather();
    }, 30 * 60 * 1000);
</script>

</body>
</html>
